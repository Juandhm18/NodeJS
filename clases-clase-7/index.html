<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Prueba CORS Frontend</title>
</head>
<body>
<h1>Frontend para probar CORS üöÄ</h1>

<label for="url">URL del backend:</label>
<input id="url" type="text" size="50" value="http://192.168.40.99:3002/users/without-streams" />
<button id="fetchBtn">Hacer petici√≥n</button>

<div style="margin-top: 20px;">
    <h3>Endpoints disponibles:</h3>
    <button onclick="testEndpoint('http://192.168.40.99:3002/users/without-streams')">Sin Streams</button>
    <button onclick="testEndpoint('http://192.168.40.99:3002/users/with-streams')">Con Streams</button>
    <button onclick="testEndpoint('http://192.168.40.99:3002/users')">Todos los usuarios</button>
    <button onclick="testEndpoint('http://192.168.40.99:3002/books')">Libros</button>
</div>

<pre id="output"></pre>

<script>
    const button = document.getElementById("fetchBtn");
    const urlInput = document.getElementById("url");
    const output = document.getElementById("output");

    button.addEventListener("click", async () => {
        const url = urlInput.value;
        await makeRequest(url);
    });

    async function testEndpoint(url) {
        urlInput.value = url;
        await makeRequest(url);
    }

    async function makeRequest(url) {
        output.textContent = "‚è≥ Enviando petici√≥n...";

        try {
            const res = await fetch(url, {
                method: "GET",
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            console.log('Response status:', res.status);
            console.log('Response headers:', res.headers);

            if (!res.ok) {
                throw new Error(`HTTP ${res.status}: ${res.statusText}`);
            }

            const data = await res.json();
            output.textContent = "‚úÖ Respuesta:\n" + JSON.stringify(data, null, 2);
        } catch (err) {
            output.textContent = "‚ùå Error: " + err.message;
            console.error('Error details:', err);
        }
    }
</script>
</body>
</html>